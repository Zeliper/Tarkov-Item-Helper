<Window x:Class="TarkovHelper.Windows.SyncResultDialog"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Quest Sync Result"
        WindowStartupLocation="CenterOwner"
        WindowStyle="None"
        AllowsTransparency="True"
        Background="Transparent"
        ResizeMode="NoResize"
        SizeToContent="WidthAndHeight"
        ShowInTaskbar="False">

    <Window.Resources>
        <BooleanToVisibilityConverter x:Key="BoolToVisibilityConverter"/>
    </Window.Resources>

    <Border Background="{DynamicResource BackgroundDarkBrush}"
            CornerRadius="8" Padding="24"
            MinWidth="700" MaxWidth="850" MaxHeight="650">
        <Border.Effect>
            <DropShadowEffect BlurRadius="20" ShadowDepth="0" Opacity="0.5"/>
        </Border.Effect>
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <!-- Header -->
            <Grid Grid.Row="0" Margin="0,0,0,16">
                <TextBlock x:Name="TxtTitle" Text="Quest Sync Complete" FontSize="{DynamicResource FontSizeXLarge}" FontWeight="SemiBold"
                           Foreground="{DynamicResource AccentBrush}"/>
                <Button x:Name="BtnClose" Content="X"
                        HorizontalAlignment="Right"
                        Padding="8,4" FontSize="{DynamicResource FontSizeSmall}"
                        Click="BtnClose_Click"/>
            </Grid>

            <!-- Two Column Layout -->
            <Grid Grid.Row="1" Margin="0,0,0,12">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="12"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <!-- Completed Quests Column -->
                <Border Grid.Column="0" Background="{DynamicResource BackgroundMediumBrush}"
                        CornerRadius="4">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>
                        <Border Grid.Row="0" Background="{DynamicResource BackgroundLightBrush}"
                                CornerRadius="4,4,0,0" Padding="12,8">
                            <TextBlock x:Name="TxtCompletedHeader" Text="Completed Quests (0)"
                                       FontSize="{DynamicResource FontSizeSmall}" FontWeight="SemiBold"
                                       Foreground="{DynamicResource TextPrimaryBrush}"/>
                        </Border>
                        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto" MaxHeight="280">
                            <ItemsControl x:Name="CompletedQuestList">
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <Border BorderThickness="0,0,0,1" BorderBrush="{DynamicResource BorderBrush}"
                                                Padding="12,6">
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="Auto"/>
                                                    <ColumnDefinition Width="*"/>
                                                    <ColumnDefinition Width="Auto"/>
                                                </Grid.ColumnDefinitions>
                                                <CheckBox Grid.Column="0" IsChecked="{Binding IsSelected, Mode=TwoWay}"
                                                          VerticalAlignment="Center" Margin="0,0,8,0"/>
                                                <StackPanel Grid.Column="1" VerticalAlignment="Center">
                                                    <TextBlock Text="{Binding QuestName}"
                                                               FontSize="{DynamicResource FontSizeXSmall}"
                                                               Foreground="{DynamicResource TextPrimaryBrush}"/>
                                                    <TextBlock Text="{Binding Trader}"
                                                               FontSize="{DynamicResource FontSizeTiny}"
                                                               Foreground="{DynamicResource TextSecondaryBrush}"/>
                                                </StackPanel>
                                                <Border Grid.Column="2"
                                                        Background="{DynamicResource AccentBrush}"
                                                        CornerRadius="3" Padding="4,2"
                                                        VerticalAlignment="Center"
                                                        Visibility="{Binding IsPrerequisite, Converter={StaticResource BoolToVisibilityConverter}}">
                                                    <TextBlock Text="Auto" FontSize="{DynamicResource FontSizeTiny}"
                                                               Foreground="{DynamicResource BackgroundDarkBrush}"/>
                                                </Border>
                                            </Grid>
                                        </Border>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                        </ScrollViewer>
                    </Grid>
                </Border>

                <!-- In Progress Quests Column -->
                <Border Grid.Column="2" Background="{DynamicResource BackgroundMediumBrush}"
                        CornerRadius="4">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>
                        <Border Grid.Row="0" Background="{DynamicResource BackgroundLightBrush}"
                                CornerRadius="4,4,0,0" Padding="12,8">
                            <TextBlock x:Name="TxtInProgressHeader" Text="In Progress (0)"
                                       FontSize="{DynamicResource FontSizeSmall}" FontWeight="SemiBold"
                                       Foreground="{DynamicResource TextPrimaryBrush}"/>
                        </Border>
                        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto" MaxHeight="280">
                            <ItemsControl x:Name="InProgressQuestList">
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <Border BorderThickness="0,0,0,1" BorderBrush="{DynamicResource BorderBrush}"
                                                Padding="12,6">
                                            <StackPanel>
                                                <StackPanel Orientation="Horizontal">
                                                    <TextBlock Text="" FontSize="{DynamicResource FontSizeTiny}"
                                                               Foreground="#FFA726"
                                                               VerticalAlignment="Center"
                                                               Margin="0,0,6,0"/>
                                                    <TextBlock Text="{Binding Name}"
                                                               FontSize="{DynamicResource FontSizeXSmall}"
                                                               Foreground="{DynamicResource TextPrimaryBrush}"/>
                                                </StackPanel>
                                                <TextBlock Text="{Binding Trader}"
                                                           FontSize="{DynamicResource FontSizeTiny}"
                                                           Foreground="{DynamicResource TextSecondaryBrush}"
                                                           Margin="16,0,0,0"/>
                                            </StackPanel>
                                        </Border>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                        </ScrollViewer>
                    </Grid>
                </Border>
            </Grid>

            <!-- Alternative Quests Selection -->
            <Border x:Name="AlternativeQuestsSection" Grid.Row="2"
                    Background="{DynamicResource BackgroundMediumBrush}"
                    CornerRadius="4" Margin="0,0,0,12"
                    Visibility="Collapsed">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    <Border Grid.Row="0" Background="#44FFA726"
                            CornerRadius="4,4,0,0" Padding="12,8">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="" FontSize="{DynamicResource FontSizeSmall}"
                                       Foreground="#FFA726" Margin="0,0,8,0" VerticalAlignment="Center"/>
                            <TextBlock x:Name="TxtAlternativeHeader"
                                       Text="Optional Quests - Choose One Per Group"
                                       FontSize="{DynamicResource FontSizeSmall}" FontWeight="SemiBold"
                                       Foreground="{DynamicResource TextPrimaryBrush}"/>
                        </StackPanel>
                    </Border>
                    <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto" MaxHeight="120">
                        <ItemsControl x:Name="AlternativeQuestsList">
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <Border BorderThickness="0,0,0,1" BorderBrush="{DynamicResource BorderBrush}"
                                            Padding="12,8">
                                        <StackPanel>
                                            <TextBlock Text="{Binding GroupLabel}"
                                                       FontSize="{DynamicResource FontSizeTiny}"
                                                       Foreground="{DynamicResource TextSecondaryBrush}"
                                                       Margin="0,0,0,6"/>
                                            <ItemsControl ItemsSource="{Binding Choices}">
                                                <ItemsControl.ItemsPanel>
                                                    <ItemsPanelTemplate>
                                                        <StackPanel Orientation="Horizontal"/>
                                                    </ItemsPanelTemplate>
                                                </ItemsControl.ItemsPanel>
                                                <ItemsControl.ItemTemplate>
                                                    <DataTemplate>
                                                        <RadioButton GroupName="{Binding GroupName}"
                                                                     IsChecked="{Binding IsSelected, Mode=TwoWay}"
                                                                     Margin="0,0,16,0"
                                                                     IsEnabled="{Binding IsEnabled}">
                                                            <StackPanel Orientation="Horizontal">
                                                                <TextBlock Text="{Binding QuestName}"
                                                                           FontSize="{DynamicResource FontSizeXSmall}"
                                                                           Foreground="{DynamicResource TextPrimaryBrush}"/>
                                                                <TextBlock Text=" (Done)"
                                                                           FontSize="{DynamicResource FontSizeTiny}"
                                                                           Foreground="{DynamicResource AccentBrush}"
                                                                           Visibility="{Binding IsCompleted, Converter={StaticResource BoolToVisibilityConverter}}"/>
                                                                <TextBlock Text=" (Failed)"
                                                                           FontSize="{DynamicResource FontSizeTiny}"
                                                                           Foreground="#EF5350"
                                                                           Visibility="{Binding IsFailed, Converter={StaticResource BoolToVisibilityConverter}}"/>
                                                            </StackPanel>
                                                        </RadioButton>
                                                    </DataTemplate>
                                                </ItemsControl.ItemTemplate>
                                            </ItemsControl>
                                        </StackPanel>
                                    </Border>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                    </ScrollViewer>
                </Grid>
            </Border>

            <!-- Summary Stats -->
            <Border Grid.Row="3" Background="{DynamicResource BackgroundMediumBrush}"
                    CornerRadius="4" Padding="12,8" Margin="0,0,0,16">
                <StackPanel>
                    <TextBlock x:Name="TxtSummaryLabel"
                               Text="Summary:"
                               FontSize="{DynamicResource FontSizeXSmall}" FontWeight="SemiBold"
                               Foreground="{DynamicResource TextPrimaryBrush}"
                               Margin="0,0,0,4"/>
                    <TextBlock x:Name="TxtStats"
                               Text=""
                               FontSize="{DynamicResource FontSizeTiny}"
                               Foreground="{DynamicResource TextSecondaryBrush}"
                               TextWrapping="Wrap"/>
                </StackPanel>
            </Border>

            <!-- Action Buttons -->
            <StackPanel Grid.Row="4" Orientation="Horizontal" HorizontalAlignment="Right">
                <Button x:Name="BtnCancel" Content="Cancel"
                        Padding="16,8" Margin="0,0,8,0"
                        Click="BtnCancel_Click"/>
                <Button x:Name="BtnConfirm" Content="Confirm"
                        Padding="16,8"
                        Click="BtnConfirm_Click"
                        Background="{DynamicResource AccentBrush}"
                        Foreground="{DynamicResource BackgroundDarkBrush}"/>
            </StackPanel>
        </Grid>
    </Border>
</Window>

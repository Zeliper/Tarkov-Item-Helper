# Tab Verification PRD

## 개요
Map, Test Map 탭을 제외한 모든 탭(Hideout, Items, Collector)의 기능 검증 및 개선 사항 정의

---

## 1. Hideout 탭

### 1.1 현재 기능
- [ ] 은신처 모듈 목록 표시
- [ ] 모듈 레벨 증가/감소 (+/-)
- [ ] 검색 기능
- [ ] 상세 패널:
  - [ ] 모듈 아이콘 및 이름 (다국어)
  - [ ] 현재 레벨 / 최대 레벨
  - [ ] 다음 레벨 요구사항:
    - [ ] 아이템 요구사항 (FIR 표시)
    - [ ] 트레이더 레벨 요구사항
    - [ ] 스킬 레벨 요구사항
    - [ ] 다른 모듈 레벨 요구사항
  - [ ] 남은 전체 아이템 요구사항
- [ ] 통계 표시 (완료/진행중/미시작 모듈 수, 레벨 진행도)
- [ ] Wiki 링크 버튼

### 1.2 검증 항목
1. **모듈 목록 로딩**
   - 모든 은신처 모듈이 표시되는지 확인
   - 아이콘이 올바르게 로딩되는지 확인

2. **레벨 조절**
   - +/- 버튼으로 레벨이 올바르게 변경되는지
   - 레벨 변경이 DB에 저장되는지 (user_data.db)
   - 앱 재시작 후 레벨이 유지되는지

3. **요구사항 표시**
   - 아이템 요구사항이 정확한지
   - FIR 표시가 올바른지
   - 이미 완료된 아이템에 취소선이 표시되는지

4. **다국어**
   - EN/KO/JA 언어 전환 시 이름이 올바르게 변경되는지

### 1.3 개선 필요 사항
- [ ] 아이템 충족 상태 표시 (인벤토리 연동)
- [ ] 진행도 프로그레스 바
- [ ] 아이템 클릭 시 Items 탭으로 이동

---

## 2. Items 탭

### 2.1 현재 기능
- [ ] 퀘스트 + 은신처 아이템 통합 목록
- [ ] 필터링:
  - [ ] 검색 (이름)
  - [ ] 소스 필터 (All/Quest/Hideout)
  - [ ] 진행도 필터 (All/Not Started/In Progress/Fulfilled)
  - [ ] FIR Only 체크박스
  - [ ] Hide Fulfilled 체크박스
  - [ ] 정렬 (Name/Total/Quest/Hideout/Progress)
- [ ] 인벤토리 수량 관리:
  - [ ] FIR 수량 (+1, +5, -1, -5, 직접 입력)
  - [ ] Non-FIR 수량 (+1, +5, -1, -5, 직접 입력)
- [ ] 상세 패널:
  - [ ] 아이템 아이콘 및 이름 (다국어)
  - [ ] Quest/Hideout/Total 수량
  - [ ] 진행도 상태 및 프로그레스 바
  - [ ] 퀘스트 출처 목록 (클릭 시 Quests 탭 이동)
  - [ ] 은신처 출처 목록
- [ ] Wiki 링크 버튼
- [ ] 통계 표시

### 2.2 검증 항목
1. **아이템 목록 로딩**
   - 퀘스트 + 은신처 아이템이 올바르게 통합되는지
   - 완료된 퀘스트/은신처 아이템은 제외되는지

2. **필터링**
   - 각 필터가 올바르게 동작하는지
   - 필터 조합이 정상 동작하는지

3. **인벤토리 관리**
   - 수량 변경이 DB에 저장되는지
   - 앱 재시작 후 수량이 유지되는지
   - 진행도 상태가 실시간 업데이트되는지

4. **탭 간 연동**
   - 퀘스트 클릭 시 Quests 탭으로 이동 및 선택
   - Hideout/Collector 탭과 인벤토리 동기화

5. **다국어**
   - EN/KO/JA 언어 전환 시 이름이 올바르게 변경되는지

### 2.3 개선 필요 사항
- [ ] 아이템 클릭 시 상세 정보 팝업
- [ ] 은신처 출처 클릭 시 Hideout 탭으로 이동
- [ ] 아이템 카테고리 필터 추가

---

## 3. Collector 탭

### 3.1 현재 기능
- [ ] Collector 퀘스트 아이템 목록
- [ ] Include Pre-Quest 체크박스 (선행 퀘스트 아이템 포함)
- [ ] 필터링:
  - [ ] 검색 (이름)
  - [ ] 진행도 필터 (All/Not Started/In Progress/Fulfilled)
  - [ ] FIR Only 체크박스
  - [ ] Hide Fulfilled 체크박스
  - [ ] 정렬 (Name/Total/Quest/Progress)
- [ ] 인벤토리 수량 관리:
  - [ ] FIR 수량 (+1, -1, 직접 입력)
  - [ ] Non-FIR 수량 (+1, -1, 직접 입력)
- [ ] 상세 패널:
  - [ ] 아이템 아이콘 및 이름 (다국어)
  - [ ] Quest/Total 수량
  - [ ] 진행도 상태 및 프로그레스 바
  - [ ] 퀘스트 출처 목록 (Kappa Required 표시, 클릭 시 Quests 탭 이동)
- [ ] Wiki 링크 버튼
- [ ] 통계 표시 (Pre-Quest 포함 여부 표시)

### 3.2 검증 항목
1. **아이템 목록 로딩**
   - Collector 퀘스트 아이템이 올바르게 표시되는지
   - Include Pre-Quest 체크 시 선행 퀘스트 아이템이 추가되는지
   - 완료된 퀘스트 아이템은 제외되는지

2. **필터링**
   - 각 필터가 올바르게 동작하는지
   - Include Pre-Quest 토글 시 목록이 즉시 업데이트되는지

3. **인벤토리 관리**
   - 수량 변경이 DB에 저장되는지
   - Items 탭과 인벤토리가 동기화되는지

4. **Kappa Required 표시**
   - Kappa 필수 퀘스트에 배지가 올바르게 표시되는지

5. **다국어**
   - EN/KO/JA 언어 전환 시 이름이 올바르게 변경되는지

### 3.3 개선 필요 사항
- [ ] Collector 퀘스트 진행도 요약 (X/Y 아이템 수집 완료)
- [ ] 선행 퀘스트 진행도 표시
- [ ] 아이템 클릭 시 Items 탭으로 이동

---

## 4. 공통 검증 항목

### 4.1 DB 저장 검증
- [ ] HideoutProgressService → user_data.db hideout_progress 테이블
- [ ] ItemInventoryService → user_data.db item_inventory 테이블 (존재 여부 확인 필요)
- [ ] 앱 재시작 후 모든 데이터 유지

### 4.2 성능 검증
- [ ] 탭 전환 시 로딩 속도
- [ ] 아이콘 로딩 속도 (백그라운드 로딩)
- [ ] 스크롤 시 렉 없음

### 4.3 이벤트 연동
- [ ] 퀘스트 완료 시 Items/Collector 탭 업데이트
- [ ] 은신처 레벨 업 시 Items 탭 업데이트
- [ ] 인벤토리 변경 시 모든 탭 업데이트

### 4.4 UI/UX
- [ ] 로딩 오버레이 표시
- [ ] 빈 상태 메시지 (아이템 없음 등)
- [ ] 에러 상태 처리

---

## 5. 검증 우선순위

### Phase 1: 기본 기능 검증
1. 각 탭 로딩 확인
2. DB 저장/로드 검증
3. 기본 필터링 동작

### Phase 2: 연동 검증
1. 탭 간 데이터 동기화
2. 탭 간 네비게이션
3. 이벤트 전파

### Phase 3: 다국어 및 UX
1. 언어 전환
2. 로딩 상태
3. 에러 처리

---

## 6. 발견된 이슈

### 6.1 DB 마이그레이션 필요 (Critical)
**현재 상태:**
- `QuestProgressService` → ✅ user_data.db 사용
- `HideoutProgressService` → ❌ hideout_progress.json 사용
- `ItemInventoryService` → ❌ item_inventory.json 사용

**필요 작업:**
1. HideoutProgressService를 DB 기반으로 변경
2. ItemInventoryService를 DB 기반으로 변경
3. 기존 JSON 데이터 마이그레이션 로직 추가

### 6.2 Hideout
(검증 후 작성)

### 6.3 Items
(검증 후 작성)

### 6.4 Collector
(검증 후 작성)

---

## 7. 구현 계획

### Step 1: HideoutProgressService DB 마이그레이션 ⬅️ 현재
- [ ] UserDataDbService에 hideout_progress 테이블 추가
- [ ] HideoutProgressService를 DB 기반으로 변경
- [ ] JSON → DB 마이그레이션 로직 추가
- [ ] 테스트 및 검증

### Step 2: ItemInventoryService DB 마이그레이션
- [ ] UserDataDbService에 item_inventory 테이블 추가
- [ ] ItemInventoryService를 DB 기반으로 변경
- [ ] JSON → DB 마이그레이션 로직 추가
- [ ] 테스트 및 검증

### Step 3: 각 탭 기능 테스트
- [ ] Hideout 탭 체크리스트 검증
- [ ] Items 탭 체크리스트 검증
- [ ] Collector 탭 체크리스트 검증
- [ ] 발견된 이슈 기록

### Step 4: 이슈 수정
- [ ] 우선순위별 이슈 수정
- [ ] 개선 사항 구현

### Step 5: 최종 검증
- [ ] 전체 기능 재검증
- [ ] 앱 재시작 후 데이터 유지 확인
- [ ] 성능 테스트

<Window x:Class="TarkovDBEditor.Views.MapPreviewWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Map Preview" Height="800" Width="1200"
        Background="#1E1E1E"
        WindowStartupLocation="CenterOwner">

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Top Controls -->
        <Border Grid.Row="0" Background="#2D2D30" Padding="10">
            <StackPanel Orientation="Horizontal">
                <!-- Map Selector -->
                <TextBlock Text="Map:" Foreground="#D4D4D4" VerticalAlignment="Center" Margin="0,0,8,0"/>
                <ComboBox x:Name="MapSelector" Width="200" Height="28" Margin="0,0,20,0"
                          SelectionChanged="MapSelector_SelectionChanged"
                          DisplayMemberPath="DisplayName"/>

                <!-- Floor Selector -->
                <TextBlock x:Name="TxtFloorLabel" Text="Floor:" Foreground="#D4D4D4"
                           VerticalAlignment="Center" Margin="0,0,8,0" Visibility="Collapsed"/>
                <ComboBox x:Name="FloorSelector" Width="150" Height="28" Margin="0,0,20,0"
                          SelectionChanged="FloorSelector_SelectionChanged" Visibility="Collapsed"/>

                <TextBlock x:Name="TxtFloorHotkeys" Text="(Numpad 0-5 for floors)" Foreground="#888"
                           VerticalAlignment="Center" FontSize="11" Visibility="Collapsed"/>

                <Separator Width="1" Background="#555" Margin="10,2"/>

                <!-- Layer Visibility -->
                <TextBlock Text="Show:" Foreground="#D4D4D4" VerticalAlignment="Center" Margin="10,0,8,0"/>
                <CheckBox x:Name="ChkShowMarkers" Content="Markers" Foreground="#4CAF50"
                          IsChecked="True" VerticalAlignment="Center" Margin="0,0,12,0"
                          Checked="LayerVisibility_Changed" Unchecked="LayerVisibility_Changed"/>
                <CheckBox x:Name="ChkShowObjectives" Content="Quest Objectives" Foreground="#FFC107"
                          IsChecked="True" VerticalAlignment="Center" Margin="0,0,12,0"
                          Checked="LayerVisibility_Changed" Unchecked="LayerVisibility_Changed"/>
                <CheckBox x:Name="ChkShowApiMarkers" Content="API Reference" Foreground="#E65100"
                          IsChecked="True" VerticalAlignment="Center"
                          Checked="LayerVisibility_Changed" Unchecked="LayerVisibility_Changed"/>

                <Separator Width="1" Background="#555" Margin="10,2"/>

                <!-- Zoom Controls -->
                <Button x:Name="BtnZoomOut" Content="-" Width="28" Height="28" Click="BtnZoomOut_Click"
                        Background="#3E3E42" Foreground="White" BorderBrush="#555"/>
                <TextBlock x:Name="ZoomText" Text="100%" Foreground="#D4D4D4" Width="60"
                           TextAlignment="Center" VerticalAlignment="Center" Margin="4,0"/>
                <Button x:Name="BtnZoomIn" Content="+" Width="28" Height="28" Click="BtnZoomIn_Click"
                        Background="#3E3E42" Foreground="White" BorderBrush="#555"/>
                <Button x:Name="BtnResetView" Content="Reset" Width="60" Height="28" Margin="10,0,0,0"
                        Click="BtnResetView_Click" Background="#3E3E42" Foreground="White" BorderBrush="#555"/>
            </StackPanel>
        </Border>

        <!-- Map Viewer -->
        <Grid Grid.Row="1" x:Name="MapViewerGrid" Background="#1A1A1A"
              ClipToBounds="True"
              MouseLeftButtonDown="MapViewer_MouseLeftButtonDown"
              MouseLeftButtonUp="MapViewer_MouseLeftButtonUp"
              MouseMove="MapViewer_MouseMove"
              MouseWheel="MapViewer_MouseWheel">

            <Canvas x:Name="MapCanvas"
                    RenderTransformOrigin="0,0">
                <Canvas.RenderTransform>
                    <TransformGroup>
                        <ScaleTransform x:Name="MapScale" ScaleX="1" ScaleY="1"/>
                        <TranslateTransform x:Name="MapTranslate" X="0" Y="0"/>
                    </TransformGroup>
                </Canvas.RenderTransform>

                <!-- SVG Map Background -->
                <svgc:SvgViewbox x:Name="MapSvg"
                                 xmlns:svgc="http://sharpvectors.codeplex.com/svgc/"
                                 Stretch="None"
                                 Canvas.Left="0" Canvas.Top="0"/>

                <!-- Markers Layer -->
                <Canvas x:Name="MarkersCanvas"/>

                <!-- Objectives Layer -->
                <Canvas x:Name="ObjectivesCanvas"/>

                <!-- API Reference Markers Layer -->
                <Canvas x:Name="ApiMarkersCanvas"/>

                <!-- Player Position Layer -->
                <Canvas x:Name="PlayerCanvas"/>
            </Canvas>
        </Grid>

        <!-- Status Bar -->
        <Border Grid.Row="2" Background="#2D2D30" Padding="10,6">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <TextBlock x:Name="StatusText" Grid.Column="0" Text="Select a map"
                           Foreground="#888"/>

                <StackPanel Grid.Column="1" Orientation="Horizontal" Margin="20,0">
                    <TextBlock Text="Markers: " Foreground="#4CAF50"/>
                    <TextBlock x:Name="MarkerCountText" Text="0" Foreground="#4CAF50" FontWeight="Bold"/>
                    <TextBlock Text="  |  Objectives: " Foreground="#FFC107" Margin="10,0,0,0"/>
                    <TextBlock x:Name="ObjectiveCountText" Text="0" Foreground="#FFC107" FontWeight="Bold"/>
                    <TextBlock Text="  |  API: " Foreground="#E65100" Margin="10,0,0,0"/>
                    <TextBlock x:Name="ApiMarkerCountText" Text="0" Foreground="#E65100" FontWeight="Bold"/>
                </StackPanel>

                <StackPanel Grid.Column="2" Orientation="Horizontal">
                    <TextBlock Text="Game: " Foreground="#888"/>
                    <TextBlock x:Name="GameCoordsText" Text="X: 0, Z: 0" Foreground="#D4D4D4" Width="150"/>

                    <!-- Player Position from Watcher -->
                    <Border CornerRadius="3" Padding="8,2" Margin="15,0,0,0"
                            Background="#333" BorderBrush="#555" BorderThickness="1">
                        <StackPanel Orientation="Horizontal">
                            <Ellipse x:Name="WatcherIndicator" Width="8" Height="8" Fill="#666" Margin="0,0,6,0"/>
                            <TextBlock x:Name="PlayerPositionText" Text="Player: --" Foreground="#00BCD4"/>
                            <Button x:Name="WatcherToggleButton" Content="Start" Padding="6,1" Margin="10,0,0,0"
                                    Background="#444" Foreground="#CCC" BorderThickness="0" FontSize="10"
                                    Click="WatcherToggleButton_Click"/>
                        </StackPanel>
                    </Border>
                </StackPanel>
            </Grid>
        </Border>
    </Grid>
</Window>
